<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout}">
<head>
    <th:block layout:fragment="pagetitle" >
        <div th:replace="partials/title-meta :: title-meta('Add New Test')"></div>
    </th:block>
</head>
<body>
<div layout:fragment="content">
    <div th:replace="~{partials/page-title :: page-title('Add New Test','Admin')}"></div>

    <div class="container">

        <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
            <strong>Success!</strong> Test added successfully.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>

        <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <strong>Something is very wrong!</strong> Please check the form and try again.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>

        <form id="testForm" th:object="${test}"
              th:action="@{'/admin/course/' + ${courseId} + '/tests/add'}"
              th:method="post">
            <!-- Hidden fields for course and lecturer -->
            <input type="hidden" th:name="courseId" th:value="${courseId}" />
            <input type="hidden" th:name="createdByUserId" th:value="${test.createdByUserId.id}" />

            <div class="mb-3">
                <label class="form-label">Name</label>
                <input type="text" th:field="*{name}" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Description</label>
                <textarea th:field="*{description}" class="form-control"></textarea>
            </div>

            <div class="mb-3">
                <label class="form-label">Duration (minutes)</label>
                <input type="number" th:field="*{durationMinutes}" class="form-control" required min="1">
            </div>

            <div class="mb-3">
                <label class="form-label">Max Score</label>
                <input type="number" step="0.01" th:field="*{maxScore}" class="form-control" required min="0">
            </div>

            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-success">Save</button>
                <a th:href="@{'/admin/course/' + ${courseId} + '/tests'}" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>
</body>
</html>